<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-/bQdsTh/da6pkI1MST/rWKFNjaCP5gBSY4sEBT38Q/9RBh9AH40zEOg7Hlq2THRZ" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link rel="stylesheet" href="home.css">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <!-- fullcalendar CDN -->
<!-- <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.8.0/main.min.css' rel='stylesheet' /> -->
<link href='./fullcallendar/main.css' rel='stylesheet' />
<!-- <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.8.0/main.min.js'></script> -->
<script src="fullcallendar/main.js"></script>
<script src="https://use.fontawesome.com/releases/v5.2.0/js/all.js"></script>
<!-- fullcalendar 언어 CDN -->
<script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.8.0/locales-all.min.js'></script>
<script src="../data/stock.json"></script>
  <title>PLANACT</title>
</head>
<body style="background-color: #fcfcfe;;">
  <div class="d-flex align-items-center row">
    <div class="col-12 d-flex align-items-center mx-3 my-2">
      <img  style="width: 30px; height: 45px; margin-right: .5rem;" src="Subtract.png">
      <h2 class="ml-2" style="font-family: Caros Soft;
      font-style: normal;
      font-weight: bold;
      font-size: 1.75rem;
      line-height: 0.75rem;
      
      color: #000000;
      ">PLANACT</h2>
    </div>
  </div>
  <div class="row">
    <div class="col-3">
      <div class="card ml-3" style="margin-top: 185px; height: 600px;
      overflow-y: scroll;">
        
        <div class="card-body">
          <ul class="list-group list-group-flush" id="plans">
            <!-- <li class="list-group-item justify-content-between">
              
              <button class="btn btn-white text-left w-100" aria-haspopup="true" type="button" data-toggle="collapse" data-target="#collapseExample" aria-expanded="false" aria-controls="collapseExample">
                전시회
              </button>
              <div class="collapse" id="collapseExample">
                <ul class="list-group">
                  <li class="list-group-item d-flex justify-content-between">
                    08.10 미술전시회
                    <div>
                      <button type="button" class="btn btn-white"><i class="far fa-eye"></i></button>
                      <button type="button" class="btn btn-white"><i class="far fa-trash-alt"></i></button>
                    </div>
                  </li>
                  <li class="list-group-item d-flex justify-content-between">
                    08.10 미술전시회
                    <div>
                      <button type="button" class="btn btn-white"><i class="far fa-eye"></i></button>
                      <button type="button" class="btn btn-white"><i class="far fa-trash-alt"></i></button>
                    </div>
                  </li>
                  <li class="list-group-item d-flex justify-content-between">
                    08.10 미술전시회
                    <div>
                      <button type="button" class="btn btn-white"><i class="far fa-eye"></i></button>
                      <button type="button" class="btn btn-white"><i class="far fa-trash-alt"></i></button>
                    </div>
                  </li>
                </ul>
              </div>
            </li>
            <li class="list-group-item justify-content-between">
              
                <button class="btn btn-white text-left" aria-haspopup="true" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="false" aria-controls="collapseExample">
                  공모주
                </button>
              <div class="collapse" id="collapse1">
                <ul class="list-group">
                  <li class="list-group-item d-flex justify-content-between">
                    셀트리온
                    <div>
                      <button type="button" class="btn btn-white"><i class="far fa-eye"></i></button>
                      <button type="button" class="btn btn-white"><i class="far fa-trash-alt"></i></button>
                    </div>
                  </li>
                  <li class="list-group-item d-flex justify-content-between">
                    카카오뱅크
                    <div>
                      <button type="button" class="btn btn-white"><i class="far fa-eye"></i></button>
                      <button type="button" class="btn btn-white"><i class="far fa-trash-alt"></i></button>
                    </div>
                  </li>
                  <li class="list-group-item d-flex justify-content-between">
                    카카오엔터테인먼트
                    <div>
                      <button type="button" class="btn btn-white"><i class="far fa-eye"></i></button>
                      <button type="button" class="btn btn-white"><i class="far fa-trash-alt"></i></button>
                    </div>
                  </li>
                </ul>
              </div>
            </li>
            <li class="list-group-item justify-content-between">
              
              <button class="btn btn-white text-left" aria-haspopup="true" type="button" data-toggle="collapse" data-target="#collapse2" aria-expanded="false" aria-controls="collapseExample">
                시험
              </button>
            <div class="collapse" id="collapse2">
              <ul class="list-group">
                <li class="list-group-item d-flex justify-content-between">
                  텝스
                  <div>
                    <button type="button" class="btn btn-white"><i class="far fa-eye"></i></button>
                    <button type="button" class="btn btn-white"><i class="far fa-trash-alt"></i></button>
                  </div>
                </li>
                <li class="list-group-item d-flex justify-content-between">
                  IBT
                  <div>
                    <button type="button" class="btn btn-white"><i class="far fa-eye"></i></button>
                    <button type="button" class="btn btn-white"><i class="far fa-trash-alt"></i></button>
                  </div>
                </li>
                <li class="list-group-item d-flex justify-content-between">
                  토플
                  <div>
                    <button type="button" class="btn btn-white"><i class="far fa-eye"></i></button>
                    <button type="button" class="btn btn-white"><i class="far fa-trash-alt"></i></button>
                  </div>
                </li>
              </ul>
            </div>
          </li> -->
          </ul>
        </div>
      </div>
    </div>
    <div class="col-6">
      <div class="container">
        <div class="row">
          <div class="input-group mb-3">
            <input style="background: #FFFFFF;
            border: 1px solid #E9E9E9;
            box-sizing: border-box;
            border-radius: 46px;" type="text" class="form-control" placeholder="search" aria-label="Recipient's username" aria-describedby="basic-addon2">
            <div class="input-group-append">
              <i class="fal fa-search"></i>
              <!-- <span class="input-group-text" id="basic-addon2">@example.com</span> -->
            </div>
          </div>
        </div>

        <div class="row card" style="margin-top: 10%; height: 483px;">
          <div id='calendar'></div>
        </div>
      </div>
    </div>
    <div class="col-3">
      <div class="card ml-3" style="
      overflow-y: scroll;">
      <h2 class="card-title">
        필터
      </h2>
      <button class="btn btn-white" id="clear">초기화</button>
        <div class="card-body">
          <div class="row">
            <h5 class="card-title">일정
              <div id="filterCalendar"></div>

            </h5>
          </div>
          <div class="row">
            <h5 class="card-title">주간사</h5>
            <div class="filters">
              <div class="bank-list d-flex" style="flex-wrap: nowrap; overflow-x: scroll;">

              </div>
            </div>
          </div>
        </div>
    </div>
    </div>
  </div>
</body>
<script>
  
  let tmpList;
  const filterbody = document.querySelector('.filters')
  const getFilterItemList = (filter,type) => {
    let acc = [];
    filter.map((item)=>{
      item[type].split(',').map(type=> acc.push(type))
    })
    let set = new Set(acc)
    acc = [...set];
    return acc;
  }
  const banks = getFilterItemList(stock, 'bank')
  console.log(banks)
  const makeFilterList = (items,name)=>{
    let ul = document.createElement('div')
    let li;
    let textnode;
    ul.classList = [`${name} filter-list d-flex`];
    ul.style.overflowX = 'scroll'
    items.map(item => {
      li = document.createElement('button')
      li.classList = "filter-list-item item list-group-item mr-1 mb-1"
      textnode = document.createTextNode(item)
      li.append(textnode)
      ul.append(li);
      li.addEventListener('click',function(e){
        $('#stock-btn').click();
        console.log(e.target.innerText)
        let keyword = e.target.innerText;
        tmpList = stock.filter(stock => stock.bank===keyword)
        $('#plans').empty()
        getAllItems(tmpList);
      })
    })
    return ul;
  }
  filterbody.append((makeFilterList(banks, 'stock')))
  const getAllItems = (filter)=>{
    let parent = $(`<li class="list-group-item justify-content-between"></li>`)
    let button = (`<button id="stock-btn" class="btn btn-white text-left w-100" aria-haspopup="true" type="button" data-toggle="collapse" data-target="#stock" aria-expanded="false" aria-controls="collapseExample">
                주식
              </button>`)
    let container = $("<div class='list-group-item justify-content-between' id='stock'></div>")
    filter.map(item => {
      let li = $(`<li class="list-group-item d-flex justify-content-between">
                    ${item.title}
                    <div>
                      <button type="button" class="btn btn-white"><i class="far fa-eye"></i></button>
                      <button type="button" class="btn btn-white"><i class="far fa-trash-alt"></i></button>
                    </div>
                  </li>`)
      container.append(li)
    })
    parent.append(button);
    parent.append(container)
    $('#plans').append(parent)

  }
  getAllItems(stock)
  $('#clear').on('click',function(){
    $('#plans').empty()
    getAllItems(stock)
  })

  // document.addEventListener('DOMContentLoaded', function() {
  //   let filterCalendar = document.getElementById("filterCalendar")
  //   let filterCal = new FullCalendar.Calendar(filterCalendar, {
  //     initialView: 'dayGridMonth',
  //     selectable:true,
  //     editable:true,
  //     dateClick: function(info){
  //       console.log("day clicked"+info.dateStr)
  //     },
  //     select:function(selectionInfo){
  //       console.log(selectionInfo.start)
  //     }
  //   });
  //   var calendarEl = document.getElementById('calendar');
  //   var calendar = new FullCalendar.Calendar(calendarEl, {
  //     initialView: 'dayGridMonth',
  //     selectable:true,
  //     editable:true,
  //     dateClick: function(info){
  //       console.log("day clicked"+info.dateStr)
  //     },
  //     select:function(selectionInfo){
  //       console.log(selectionInfo.start)
  //     }
  //   });
  //   calendar.render();
  //   filterCal.render();
  // });

</script>
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
</html>